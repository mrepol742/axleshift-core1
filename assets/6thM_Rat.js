/**
 * Â© 2025 Melvin Jones Repol & its contributors . All rights reserved.
 * This project is licensed under the MIT License with Commons Clause.
*/
import{r as e,R as o}from"./CbKKHx2O.js";const r=e.createContext(null);function n({clientId:n,nonce:c,onScriptLoadSuccess:t,onScriptLoadError:u,children:i}){const l=function(o={}){const{nonce:r,onScriptLoadSuccess:n,onScriptLoadError:c}=o,[t,u]=e.useState(!1),i=e.useRef(n);i.current=n;const l=e.useRef(c);return l.current=c,e.useEffect((()=>{const e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=r,e.onload=()=>{var e;u(!0),null===(e=i.current)||void 0===e||e.call(i)},e.onerror=()=>{var e;u(!1),null===(e=l.current)||void 0===e||e.call(l)},document.body.appendChild(e),()=>{document.body.removeChild(e)}}),[r]),t}({nonce:c,onScriptLoadSuccess:t,onScriptLoadError:u}),s=e.useMemo((()=>({clientId:n,scriptLoadedSuccessfully:l})),[n,l]);return o.createElement(r.Provider,{value:s},i)}function c({flow:o="implicit",scope:n="",onSuccess:c,onError:t,onNonOAuthError:u,overrideScope:i,state:l,...s}){const{clientId:d,scriptLoadedSuccessfully:a}=function(){const o=e.useContext(r);if(!o)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return o}(),v=e.useRef(),f=e.useRef(c);f.current=c;const p=e.useRef(t);p.current=t;const m=e.useRef(u);m.current=u,e.useEffect((()=>{var e,r;if(!a)return;const c="implicit"===o?"initTokenClient":"initCodeClient",t=null===(r=null===(e=null===window||void 0===window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===r?void 0:r.oauth2[c]({client_id:d,scope:i?n:`openid profile email ${n}`,callback:e=>{var o,r;if(e.error)return null===(o=p.current)||void 0===o?void 0:o.call(p,e);null===(r=f.current)||void 0===r||r.call(f,e)},error_callback:e=>{var o;null===(o=m.current)||void 0===o||o.call(m,e)},state:l,...s});v.current=t}),[d,a,o,n,l]);const S=e.useCallback((e=>{var o;return null===(o=v.current)||void 0===o?void 0:o.requestAccessToken(e)}),[]),h=e.useCallback((()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.requestCode()}),[]);return"implicit"===o?S:h}export{n as G,c as u};
