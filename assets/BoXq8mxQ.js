/**
 * Â© 2025 Melvin Jones Repol & its contributors . All rights reserved.
 * This project is licensed under the MIT License with Commons Clause.
*/
import{r as e,R as s,j as t}from"./CbKKHx2O.js";import{R as i}from"./DfG9QjQz.js";import{F as r,a,a3 as o}from"./ru3Q0AV5.js";import{b as l,e as n}from"./CWns3eDK.js";import"./schw12Bp.js";import{d as m}from"./D_eMUV-T.js";import{d as c,T as p,U as j,a as d,Q as h,R as u}from"./BCoDuBWI.js";import"./D9QqU1Un.js";import"./z-cSZRUs.js";import"./vr9ZyHRf.js";import"./DylAs1sT.js";import"./yJGO6Amu.js";import"./tM1qHAtJ.js";import"./CvkuIoXT.js";import"./B3ZIOLOa.js";import"./U6rf_yqH.js";import"./D68gzNyG.js";import"./6thM_Rat.js";import"./Eji1Pm7n.js";import"./CUBhYDUo.js";import"./Bhaa8ZPc.js";import"./K-dupnmX.js";import"./B3MjVzzP.js";import"./cwKO6bxQ.js";import"./C3hrCPXF.js";import"./Dw0KO6EP.js";import"./CzGuHLZU.js";import"./Bd5YRvRe.js";import"./UUb1f1Eq.js";import"./DqkGgfGl.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./C76xSmx-.js";import"./BPjVUy-D.js";import"./CTpwok2W.js";import"./Bzwk9agu.js";import"./BqHrj3jM.js";const x=()=>{const x=m(),{addToast:w}=l(),[f,v]=e.useState(!1),[y,g]=e.useState(!1),k=s.useRef(),[_,b]=e.useState({note:"",whitelist_ip:[""]});return f?t.jsx("div",{className:"loading-overlay",children:t.jsx(c,{color:"primary",variant:"grow"})}):t.jsxs(p,{onSubmit:async e=>{e.preventDefault();const s=await k.current.executeAsync();v(!0),axios.post("/auth/token/new",{..._,recaptcha_ref:s}).then((e=>{if(e.data.error)return w(e.data.error);x("/security/access-token"),setTimeout((()=>{x("/security/access-token",{state:{token:e.data.token}})}),1500)})).catch((e=>{var s,t;const i=(null==(t=null==(s=e.response)?void 0:s.data)?void 0:t.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);w(i)})).finally((()=>v(!1)))},children:[t.jsx(i,{ref:k,size:"invisible",sitekey:n}),t.jsx("h4",{children:"New Access Token"}),t.jsx("p",{className:"text-muted",children:"This can be used to authenticate with the API via HTTPS."}),t.jsx(j,{type:"text",id:"note",name:"note",label:"Note",value:_.note,onChange:e=>b({..._,note:e.target.value})}),t.jsx("small",{className:"text-muted",children:"Whats this token for?"}),t.jsxs("div",{className:"mt-3",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("h4",{children:"Whitelist IP"}),t.jsxs(d,{size:"sm",className:"text-white ms-auto",onClick:()=>Array.isArray(_.whitelist_ip)?_.whitelist_ip.length<6?b((e=>({...e,whitelist_ip:[...e.whitelist_ip,""]}))):void w("Max number of whitelisted ip address reached"):b((e=>({...e,whitelist_ip:[""]}))),disabled:y,children:[t.jsx(r,{icon:a})," Add"]})]}),_.whitelist_ip&&0!==_.whitelist_ip.length&&t.jsx(h,{className:"mb-3",children:t.jsx(u,{children:_.whitelist_ip.map(((e,s)=>t.jsxs("div",{className:"d-flex mb-2",children:[t.jsx(j,{value:e,onChange:e=>((e,s)=>{const t=[..._.whitelist_ip];t[e]=s,b((e=>({...e,whitelist_ip:t})))})(s,e.target.value),placeholder:`192.168.0.${s+1}`}),t.jsx(d,{color:"danger",className:"text-white ms-2",onClick:e=>(e=>{if(1===_.whitelist_ip.length)return void w("Cannot delete the only IP address in the whitelist");const s=_.whitelist_ip.filter(((s,t)=>t!==e));b((e=>({...e,whitelist_ip:s})))})(s),children:t.jsx(r,{icon:o})})]},s)))})}),t.jsxs("div",{className:"d-flex mt-4",children:[t.jsx(d,{type:"submit",color:"primary",className:"me-2 rounded",children:"Generate"}),t.jsx(d,{type:"button",color:"outline-secondary",className:"rounded",onClick:e=>x("/security/access-token"),children:"Cancel"})]})]})};export{x as default};
