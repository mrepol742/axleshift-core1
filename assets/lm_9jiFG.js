/**
 * Â© 2025 Melvin Jones Repol & its contributors . All rights reserved.
 * This project is licensed under the MIT License with Commons Clause.
*/
import{r as s,R as a,j as t}from"./CbKKHx2O.js";import{H as r}from"./VudaBnFI.js";import{R as l}from"./DfG9QjQz.js";import{F as i,X as n}from"./ru3Q0AV5.js";import{u as o,b as d,e as c}from"./CWns3eDK.js";import{k as m,d as p}from"./D_eMUV-T.js";import{d as u,b as j,c as h,T as x,a as f,Q as g,R as b,a2 as v,a3 as y,a4 as w,a5 as N,a6 as S,a7 as k,U as D,e as O,f as C,g as F,h as z}from"./BCoDuBWI.js";import"./D9QqU1Un.js";import"./z-cSZRUs.js";import"./Bnu3OxD9.js";import"./BNqS-k40.js";import"./0NUvlLuB.js";import"./vr9ZyHRf.js";import"./DylAs1sT.js";import"./yJGO6Amu.js";import"./tM1qHAtJ.js";import"./CvkuIoXT.js";import"./B3ZIOLOa.js";import"./U6rf_yqH.js";import"./D68gzNyG.js";import"./6thM_Rat.js";import"./Eji1Pm7n.js";import"./CUBhYDUo.js";import"./Bhaa8ZPc.js";import"./K-dupnmX.js";import"./B3MjVzzP.js";import"./cwKO6bxQ.js";import"./C3hrCPXF.js";import"./Dw0KO6EP.js";import"./CzGuHLZU.js";import"./Bd5YRvRe.js";import"./UUb1f1Eq.js";import"./DqkGgfGl.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./C76xSmx-.js";import"./BPjVUy-D.js";import"./CTpwok2W.js";import"./Bzwk9agu.js";import"./BqHrj3jM.js";const $=()=>{const{id:$}=m(),_=p(),{user:R}=o(),[T,P]=s.useState(!0),{addToast:A}=d(),E=a.useRef(),[L,X]=s.useState(null),[q,M]=s.useState(null),[U,B]=s.useState(null),[H,Q]=s.useState(!1),[W,G]=s.useState(null),[I,J]=s.useState([]);return s.useEffect((()=>{(async()=>{axios.get(`/documents/${$}`).then((e=>{X(e.data.documents),J(e.data.documents.filter((e=>"generated"!==e.status)))})).finally((()=>P(!1)))})()}),[]),T?t.jsx("div",{className:"loading-overlay",children:t.jsx(u,{color:"primary",variant:"grow"})}):L?t.jsxs(t.Fragment,{children:[t.jsx(r,{children:t.jsxs("title",{children:[$," - Documents | Axleshift"]})}),t.jsxs(x,{onSubmit:async e=>{e.preventDefault();const s=await E.current.executeAsync();P(!0);const a=new FormData;a.append("exportLicense",q),a.append("certificateOfOrigin",U),a.append("recaptcha_ref",s),axios.post(`/documents/${$}/upload`,a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{X(e.data.data),J(e.data.data.documents.filter((e=>"generated"!==e.status))),A("Documents uploaded successfully!","success")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);A(t,"danger")})).finally((()=>P(!1)))},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[t.jsxs("div",{children:[t.jsx("h2",{children:"Documents"}),t.jsx("span",{className:"text-muted",children:$})]}),["super_admin","admin"].includes(R.role)&&t.jsx(f,{size:"sm",color:"info",disabled:I.length<0,onClick:e=>(async()=>{P(!0),axios.post(`/documents/cooel/${$}`,{is_enabled:!(I.length>0)}).then((e=>{if(e.data.error)return A(e.data.error);X(e.data.data),J(e.data.data.filter((e=>"generated"!==e.status))),A(I.length>0?"Documents has been removed":"Documents has been added","success")})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);A(t)})).finally((()=>P(!1)))})(),children:I.length>0?"Remove COO/EL":"Require COO/EL"})]}),t.jsx(g,{className:"mt-2 mb-3",children:t.jsxs(b,{children:[t.jsxs(v,{stripedColumns:!0,hover:!0,responsive:!0,className:"table-even-width",children:[t.jsx(y,{children:t.jsxs(w,{children:[t.jsx(N,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Document Name"}),t.jsx(N,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Type"}),t.jsx(N,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Status"}),t.jsx(N,{className:"text-uppercase fw-bold text-muted poppins-regular table-header-cell-no-wrap",children:"Upload"})]})}),t.jsx(S,{children:L.map(((s,a)=>t.jsx(t.Fragment,{children:"not_applicable"!==s.status&&t.jsxs(w,{children:[t.jsxs(k,{children:[t.jsx("span",{className:"d-block",children:s.name}),s.file&&t.jsxs(f,{color:"primary",size:"sm",variant:"ghost",onClick:e=>((e,s)=>{if(/bill-of-lading-AX-[0-9]/.test(s))return _(`/documents/${e}/bill-of-lading`);Q(!0),axios.post(`/documents/file/${e}`,{file:s}).then((e=>{if(e.data.error)return A(e.data.error);G(e.data)})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);A(t)})).finally((()=>P(!1)))})($,s.file.file),children:[t.jsx(i,{icon:n,className:"me-1"})," ","Open File"]})]}),t.jsx(k,{children:s.type}),t.jsx(k,{className:"text-capitalize",children:t.jsx("span",{className:"badge bg-"+(["approved","generated"].includes(s.status)?"success":"rejected"===s.status?"danger":"warning"),children:s.status.replace("_"," ")})}),t.jsx(k,{children:s.file&&"rejected"!==s.status?s.file.file:t.jsxs(t.Fragment,{children:[t.jsx(D,{type:"file",accept:".docx,.pdf",onChange:s=>((s,a)=>{const t=s.target.files[0];if(t&&t.size>26214400)return A("File size exceeds 25MB limit. Please upload a smaller file."),void(e.target.value=null);if(t){const e=[...L];e[a]={...e[a],status:"under_review"},X(e),0===a&&M(t),1===a&&B(t)}})(s,a),disabled:["approved","not_applicable"].includes(s.status)||"admin"===R.role}),s.file&&t.jsx("span",{className:"text-danger text-decoration-line-through",children:s.file.file})]})})]},a)})))})]}),t.jsxs("span",{className:"d-block mb-2 small",children:["Please ensure that the documents you upload are accurate and comply with all applicable laws and regulations.",t.jsx("br",{}),"Submitting false or fraudulent documents may result in legal consequences."]}),t.jsx(f,{color:"primary",type:"submit",disabled:!q&&!U,children:"Submit Documents"}),t.jsx(l,{ref:E,size:"invisible",sitekey:c})]})})]}),t.jsxs(O,{alignment:"center",scrollable:!0,fullscreen:"sm",visible:H,onClose:()=>Q(!1),"aria-labelledby":"M",children:[t.jsx(C,{children:t.jsx(F,{children:null==W?void 0:W.file})}),t.jsx(z,{children:"docx"===(null==W?void 0:W.fileFormat)?t.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${null==W?void 0:W.url}`,style:{width:"100%",height:"400px",border:"none"}}):t.jsx("iframe",{src:null==W?void 0:W.url,style:{width:"100%",height:"400px",border:"none"},title:"Document Preview"})})]})]}):t.jsx(j,{className:"justify-content-center my-5",children:t.jsx(h,{md:6,children:t.jsxs("div",{className:"clearfix",children:[t.jsx("h1",{className:"float-start display-3 me-4 text-danger",children:"OOPS"}),t.jsx("h4",{children:"There was no shipment documents found."}),t.jsx("p",{children:"Double check tracking number for any mistake."})]})})})};export{$ as default};
