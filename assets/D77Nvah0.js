/**
 * © 2025 Melvin Jones Repol & its contributors . All rights reserved.
 * This project is licensed under the MIT License with Commons Clause.
*/
import{r as e,R as s,j as a}from"./CbKKHx2O.js";import{R as t}from"./DfG9QjQz.js";import{F as r,U as i}from"./ru3Q0AV5.js";import{b as o,e as n}from"./CWns3eDK.js";import{A as l}from"./schw12Bp.js";import{p as c}from"./2aPQtUzY.js";import{d,a as m}from"./D_eMUV-T.js";import{d as j,S as p,a as x,b as h,c as u,C as f,Q as g,R as N,e as k,f as b,g as v,h as y,i as w}from"./BCoDuBWI.js";import"./D9QqU1Un.js";import"./z-cSZRUs.js";import"./vr9ZyHRf.js";import"./DylAs1sT.js";import"./yJGO6Amu.js";import"./tM1qHAtJ.js";import"./CvkuIoXT.js";import"./B3ZIOLOa.js";import"./U6rf_yqH.js";import"./D68gzNyG.js";import"./6thM_Rat.js";import"./Eji1Pm7n.js";import"./CUBhYDUo.js";import"./Bhaa8ZPc.js";import"./K-dupnmX.js";import"./B3MjVzzP.js";import"./cwKO6bxQ.js";import"./C3hrCPXF.js";import"./Dw0KO6EP.js";import"./CzGuHLZU.js";import"./Bd5YRvRe.js";import"./UUb1f1Eq.js";import"./DqkGgfGl.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./C76xSmx-.js";import"./BPjVUy-D.js";import"./CTpwok2W.js";import"./Bzwk9agu.js";import"./BqHrj3jM.js";const S=()=>{var S;const T=d(),{addToast:C}=o(),[_,P]=e.useState(!0),A=s.useRef(),[z,D]=e.useState([]),[R,G]=e.useState(1),[L,M]=e.useState(0),[E,F]=e.useState(null),[I,O]=e.useState(!1),Q=null==(S=m().state)?void 0:S.token,U=async e=>{axios.post("/auth/token/",{page:e}).then((e=>{D(e.data.data),M(e.data.totalPages)})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);C(t)})).finally((()=>P(!1)))};return e.useEffect((()=>{U(R)}),[R]),_?a.jsx("div",{className:"loading-overlay",children:a.jsx(j,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[Q&&a.jsxs("div",{children:["Make sure to copy your personal access token now. You won’t be able to see it again!",a.jsxs(p,{color:"info",className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{children:Q}),a.jsx(x,{color:"primary",size:"sm",onClick:()=>{navigator.clipboard.writeText(Q),C("Token copied to clipboard")},children:a.jsx(r,{icon:i})})]})]}),a.jsx(t,{ref:A,size:"invisible",sitekey:n}),a.jsxs(h,{className:"align-items-center mb-2",children:[a.jsx(u,{children:a.jsx("h4",{className:"mb-0",children:"Access Token"})}),a.jsx(u,{className:"text-right d-flex justify-content-end",children:a.jsx(x,{color:"primary",size:"sm",onClick:e=>T("/security/access-token/new"),className:"text-right d-flex justify-content-end",children:"Generate new token"})})]}),!z||0==z.length&&a.jsx(f,{className:"my-5",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"text-body-secondary",children:[a.jsx("h1",{className:"d-block text-danger",children:"No Access Tokens added yet."}),a.jsx("span",{children:'Please click "Generate New Token" to create a Token.'})]})})}),z&&z.map(((e,s)=>a.jsx(g,{className:"mb-3",children:a.jsxs(N,{children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("h3",{className:"text-primary text-truncate",children:e.note}),a.jsx(x,{color:"danger",onClick:s=>(e=>{F(e),O(!0)})(e),className:"ms-auto",children:"Delete"})]}),a.jsxs("div",{className:"d-block d-sm-flex",children:[a.jsxs("div",{className:"me-3 mb-2",children:[a.jsx("span",{className:"text-muted",children:"Last accessed"}),a.jsxs("span",{className:"d-block small",children:[e.last_accessed?c(e.last_accessed):"Never"," ","| ",e.user_agent?e.user_agent:"NaN"]})]}),a.jsxs("div",{className:"me-3 mb-2",children:[a.jsx("span",{className:"text-muted",children:"Date created"}),a.jsx("span",{className:"d-block small",children:new Date(e.created_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-muted",children:"IP Address"}),a.jsx("span",{className:"d-block small text-capitalize",children:"::1"===e.ip_address?"localhost":e.ip_address})]})]})]})},s))),L>1&&a.jsx(l,{currentPage:R,setCurrentPage:G,totalPages:L,setTotalPages:M}),a.jsxs(k,{alignment:"center",scrollable:!0,visible:I,onClose:()=>O(!1),"aria-labelledby":"M",children:[a.jsx(b,{children:a.jsxs(v,{children:["Confirm Delete ",null==E?void 0:E.note,"?"]})}),a.jsx(y,{children:"Are you sure you want to delete the selected Token? This action cannot be undone."}),a.jsxs(w,{className:"d-flex justify-content-end",children:[a.jsx(x,{color:"secondary",onClick:async()=>{O(!1);const e=await A.current.executeAsync();P(!0),axios.post("/auth/token/delete",{id:E._id,recaptcha_ref:e}).then((e=>U(1))).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||("network error"===e.message?"Server is offline or restarting please wait":e.message);C(t)})).finally((()=>P(!1)))},children:"Delete"}),a.jsx(x,{color:"primary",onClick:()=>{O(!1)},className:"ms-2",children:"Cancel"})]})]})]})};export{S as default};
