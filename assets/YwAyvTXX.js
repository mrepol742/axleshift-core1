/**
 * Â© 2025 Melvin Jones Repol & its contributors . All rights reserved.
 * This project is licensed under the MIT License with Commons Clause.
*/
import{R as e,r as s,j as a}from"./CbKKHx2O.js";import{R as t}from"./DfG9QjQz.js";import{b as o,e as r}from"./CWns3eDK.js";import{d as l,b as i,c as n,a as c,C as m,Y as d,U as j,al as h,e as p,f as x,g as u,h as b,i as g}from"./BCoDuBWI.js";import"./D9QqU1Un.js";import"./z-cSZRUs.js";import"./vr9ZyHRf.js";import"./DylAs1sT.js";import"./yJGO6Amu.js";import"./tM1qHAtJ.js";import"./D_eMUV-T.js";import"./CvkuIoXT.js";import"./B3ZIOLOa.js";import"./U6rf_yqH.js";import"./D68gzNyG.js";import"./6thM_Rat.js";import"./Eji1Pm7n.js";import"./CUBhYDUo.js";import"./Bhaa8ZPc.js";import"./K-dupnmX.js";import"./B3MjVzzP.js";import"./cwKO6bxQ.js";import"./C3hrCPXF.js";import"./Dw0KO6EP.js";import"./CzGuHLZU.js";import"./Bd5YRvRe.js";import"./UUb1f1Eq.js";import"./ru3Q0AV5.js";import"./DqkGgfGl.js";import"./BXEMiIsG.js";import"./Bb7MnDjl.js";import"./C76xSmx-.js";import"./BPjVUy-D.js";import"./CTpwok2W.js";import"./Bzwk9agu.js";import"./BqHrj3jM.js";const f=()=>{const f=e.useRef(),{addToast:k}=o(),[v,y]=s.useState(!1),[N,C]=s.useState([]),[w,S]=s.useState([]),[W,L]=s.useState(!1);s.useEffect((()=>{(async()=>{axios.get("/sec/webhooks").then((e=>{C(e.data),S(e.data)})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||e.message||"Server is offline or restarting please wait";k(t)})).finally((()=>y(!1)))})()}),[]);const A=(e,s,a)=>{const t=[...N];t[e][a]=s,C(t)};return v?a.jsx("div",{className:"loading-overlay",children:a.jsx(l,{color:"primary",variant:"grow"})}):a.jsxs("div",{children:[a.jsx(t,{ref:f,size:"invisible",sitekey:r}),a.jsxs(i,{className:"align-items-center mb-2",children:[a.jsx(n,{children:a.jsx("h4",{className:"mb-0",children:"Webhooks"})}),a.jsxs(n,{className:"text-right d-flex justify-content-end",children:[a.jsx(c,{color:"primary",onClick:()=>{C([...N,{url:"",checked:!1}])},children:"New"}),a.jsx(c,{color:"danger",onClick:()=>{if(0===N.filter((e=>e.checked)).length)return k("Please select at least one Webhook to delete.");L(!0)},className:"ms-2",children:"Delete"})]})]}),0===N.length&&0===w.length&&a.jsx(m,{className:"my-5",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"text-body-secondary",children:[a.jsx("h1",{className:"d-block text-danger",children:"No Webhooks added yet."}),a.jsx("span",{children:'Please click "New" to add a Webhook.'})]})})}),N.map(((e,s)=>a.jsxs("div",{className:"d-block d-md-flex mb-2 gap-2",children:[a.jsx(d,{className:"me-3",checked:e.checked,onChange:e=>((e,s)=>{const a=[...N];a[e].checked=s,C(a)})(s,e.target.checked)}),a.jsx(j,{type:"text",value:e.url,floatingLabel:"URL",onChange:e=>A(s,e.target.value,"url"),className:"me-2 mb-2 mb-md-0"}),a.jsx(j,{type:"text",floatingLabel:"Token",value:e.token,onChange:e=>A(s,e.target.value,"token"),className:"me-2 mb-2 mb-md-0"}),a.jsxs(h,{value:e.action,floatingLabel:"Action",onChange:e=>A(s,e.target.value,"action"),className:"me-2 mb-2 mb-md-0",children:[a.jsx("option",{value:"",children:"Choose"}),a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"invoices",children:"Invoices"}),a.jsx("option",{value:"shipments",children:"Shipments"}),a.jsx("option",{value:"documents",children:"Documents"})]})]},s))),a.jsx(c,{color:"primary",onClick:async()=>{const e=await f.current.executeAsync();y(!0),axios.post("/sec/webhooks",{recaptcha_ref:e,WebhooksLocationList:N}).then((e=>{if(e.data.error)return k(e.data.error);k("Webhooks updated successfully"),S(N)})).catch((e=>{var s,a;const t=(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.error)||e.message||"Server is offline or restarting please wait";k(t)})).finally((()=>y(!1)))},className:"mb-4",disabled:0===N.length&&0===w.length,children:"Apply all changes"}),a.jsxs(p,{alignment:"center",scrollable:!0,visible:W,onClose:()=>L(!1),"aria-labelledby":"M",children:[a.jsx(x,{children:a.jsx(u,{children:"Confirm Delete?"})}),a.jsxs(b,{children:[a.jsx("ul",{children:N.filter((e=>e.checked)).map(((e,s)=>a.jsx("li",{children:e.url},s)))}),"Are you sure you want to delete the selected Webhooks? This action cannot be undone."]}),a.jsxs(g,{className:"d-flex justify-content-end",children:[a.jsx(c,{color:"secondary",onClick:()=>{L(!1),C(N.filter((e=>!e.checked)))},children:"Delete"}),a.jsx(c,{color:"primary",onClick:()=>{L(!1)},className:"ms-2",children:"Cancel"})]})]})]})};export{f as default};
